import{_ as x,r as I,o as r,c as i,a as t,F as h,b as f,d as b,t as d,w as n,v as c,e as u,f as v,g as y,h as D}from"./index-5d22d37e.js";const{VITE_APP_API:m,VITE_APP_PATH:p}={VITE_APP_API:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"charizard",BASE_URL:"/perfume/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},V={components:{},data(){return{email:"dasd",productId:"",products:[],cart:{},loadingItem:"",infoIsLoading:!1,addToCartIsLoading:!1,deleteItemIsLoading:!1,orderData:{data:{user:{name:"",email:"",tel:"",address:""},message:""}}}},methods:{getCart(){this.$http.get(`${m}/v2/api/${p}/cart`).then(o=>{this.cart=o.data.data,console.log(o.data.data)})},updateCart(o){this.loadingItem=o.id;const s={product_id:o.product.id,qty:o.qty};this.$http.put(`${m}/v2/api/${p}/cart/${o.id}`,{data:s}).then(()=>{this.loadingItem="",this.getCart()})},deleteItem(o){this.loadingItem=o.id,this.deleteItemIsLoading=!0,this.$http.delete(`${m}/v2/api/${p}/cart/${o.id}`).then(()=>{this.loadingItem="",this.getCart(),this.deleteItemIsLoading=!1})},isPhone(o){return/^(09)[0-9]{8}$/.test(o)?!0:"需要正確的電話號碼"},createOrder(o){this.cart===""?alert("請加入購買品項!"):(this.$http.post(`${m}/v2/api/${p}/order`,o).then(s=>{console.log("jljkljlsd:",s.data)}).catch(s=>console.log(s)),alert("送出成功!"),this.cart="")}},mounted(){this.getCart()}},C={class:"table align-middle"},P=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",{class:"text-end"},"單價")])],-1),k=["onClick","disabled"],E={key:0,class:"fas fa-spinner fa-pulse"},A=t("div",{class:"text-success"}," 已套用優惠券 ",-1),T={class:"input-group input-group-sm"},L={class:"input-group mb-3"},U=["onUpdate:modelValue","onChange","disabled"],w=["value"],N={class:"input-group-text",id:"basic-addon2"},S={class:"text-end"},j=t("small",{class:"text-success"},"折扣價：",-1),q=t("td",{colspan:"3",class:"text-end"},"總計",-1),B={class:"text-end"},O=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),M={class:"text-end text-success"},R={class:"my-5 row justify-content-center"},$={class:"mb-3"},F=t("label",{for:"email",class:"form-label"},"Email",-1),H={class:"mb-3"},z=t("label",{for:"name",class:"form-label"},"收件人姓名",-1),G={class:"mb-3"},J=t("label",{for:"tel",class:"form-label"},"收件人電話",-1),K={class:"mb-3"},Q=t("label",{for:"address",class:"form-label"},"收件人地址",-1),W={class:"mb-3"},X=t("label",{for:"message",class:"form-label"},"留言",-1),Y={class:"text-end"},Z=t("button",{type:"button",class:"btn btn-primary mx-3"},"繼續逛逛",-1),tt=t("button",{type:"submit",class:"btn btn-danger"},"送出訂單",-1);function et(o,s,st,at,a,_){const g=I("router-link");return r(),i(h,null,[t("table",C,[P,t("tbody",null,[a.cart.carts?(r(!0),i(h,{key:0},f(a.cart.carts,e=>(r(),i("tr",{key:e.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:l=>_.deleteItem(e),disabled:e.id===a.loadingItem},[this.deleteItemIsLoading?(r(),i("i",E)):b("",!0),u(" x ")],8,k)]),t("td",null,[u(d(e.product.title)+" ",1),A]),t("td",null,[t("div",T,[t("div",L,[n(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":l=>e.qty=l,onChange:l=>_.updateCart(e),disabled:e.id===a.loadingItem},[(r(),i(h,null,f(20,l=>t("option",{value:l,key:`${l}123456`},d(l),9,w)),64))],40,U),[[D,e.qty]]),t("span",N,d(e.product.unit),1)])])]),t("td",S,[j,u(" "+d(e.product.price),1)])]))),128)):b("",!0)]),t("tfoot",null,[t("tr",null,[q,t("td",B,d(a.cart.total),1)]),t("tr",null,[O,t("td",M,d(a.cart.final_total),1)])])]),t("div",R,[t("form",{ref:"form",class:"col-md-6",onSubmit:s[5]||(s[5]=e=>_.createOrder(this.orderData))},[t("div",$,[F,n(t("input",{id:"email",name:"email","onUpdate:modelValue":s[0]||(s[0]=e=>a.orderData.data.user.email=e),type:"email",class:"form-control",placeholder:"請輸入 Email"},null,512),[[c,a.orderData.data.user.email]])]),u(" "+d(a.orderData.data.user.email)+" ",1),t("div",H,[z,n(t("input",{id:"name",name:"姓名","onUpdate:modelValue":s[1]||(s[1]=e=>a.orderData.data.user.name=e),type:"text",class:"form-control",placeholder:"請輸入姓名"},null,512),[[c,a.orderData.data.user.name]])]),t("div",G,[J,n(t("input",{id:"tel",name:"電話","onUpdate:modelValue":s[2]||(s[2]=e=>a.orderData.data.user.tel=e),type:"text",class:"form-control",placeholder:"請輸入電話"},null,512),[[c,a.orderData.data.user.tel]])]),t("div",K,[Q,n(t("input",{id:"address",name:"地址","onUpdate:modelValue":s[3]||(s[3]=e=>a.orderData.data.user.address=e),type:"text",class:"form-control",placeholder:"請輸入地址"},null,512),[[c,a.orderData.data.user.address]])]),t("div",W,[X,n(t("textarea",{id:"message",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=e=>a.orderData.data.message=e),cols:"30",rows:"10"},null,512),[[c,a.orderData.data.message]])]),t("div",Y,[v(g,{to:"/"},{default:y(()=>[Z]),_:1}),tt])],544)])],64)}const lt=x(V,[["render",et]]);export{lt as default};
